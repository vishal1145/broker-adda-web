module.exports=[8831,a=>{"use strict";a.s(["default",()=>o],8831);var b=a.i(64144),c=a.i(75055),d=a.i(39603),e=a.i(30092),f=a.i(40268),g=a.i(36042),h=a.i(62768);function i(){let{user:a}=(0,g.useAuth)(),e=(0,d.useRouter)(),[f,h]=(0,c.useState)(null),[i,j]=(0,c.useState)(!0),[k,l]=(0,c.useState)("");(0,c.useEffect)(()=>{(async()=>{try{if(j(!0),l(""),!a?.token)return void j(!1);let b=a.userId;if(!b){j(!1),l("Customer ID not found");return}let c=await fetch(`https://broker-adda-be.fly.dev/api/customers/${b}`,{headers:{Authorization:`Bearer ${a.token}`,Accept:"application/json"}});if(404===c.status)return void e.push("/customer-profile?mode=create");if(!c.ok)throw Error("Failed to load customer profile");let d=await c.json(),f=d?.data?.customer||d?.data||d;if(!f||!f.name&&!f.email)return void e.push("/customer-profile?mode=create");h(f||null)}catch(a){l("Failed to load profile")}finally{j(!1)}})()},[a?.userId,a?.token]);let m=(0,c.useMemo)(()=>{let a=a=>"string"==typeof a&&a.trim().length>0&&"null"!==a&&"undefined"!==a,b=(...b)=>b.find(a)||"",c=b(f?.createdAt,f?.joinedAt),d=c?new Date(c):null,e=f?.preferences||f?.additionalDetails?.preferences||{},g=e.propertyType||[],h=b(f?.dateOfBirth,f?.dob,f?.customerDetails?.dateOfBirth),i="-";if(h)try{let a=new Date(h);isNaN(a.getTime())||(i=a.toLocaleDateString(void 0,{day:"2-digit",month:"short",year:"numeric"}))}catch(b){let a=h.match(/^\d{4}-\d{2}-\d{2}/);if(a)try{let b=new Date(a[0]);isNaN(b.getTime())||(i=b.toLocaleDateString(void 0,{day:"2-digit",month:"short",year:"numeric"}))}catch(a){}}return{name:b(f?.name,f?.user?.name,f?.userId?.name,"Unknown"),email:b(f?.email,f?.user?.email,f?.userId?.email),phone:b(f?.phone,f?.user?.phone,f?.userId?.phone,f?.mobile),gender:b(f?.gender),dateOfBirth:i,joinedDateFormatted:d?d.toLocaleDateString(void 0,{day:"2-digit",month:"short",year:"numeric"}):"",image:(a=>{if(!a||"string"!=typeof a)return a;let b="https://broker-adda-be.fly.dev";if(a.startsWith("/opt/lampp/htdocs/")){let c=a.split("/").pop();return`${b}/uploads/${c}`}return a.startsWith("/uploads/")?`${b}${a}`:a})(b(f?.customerImage,f?.images?.customerImage,f?.files?.customerImage,f?.profileImage,f?.image,"/images/user-1.webp")),budgetMin:e.budgetMin||"",budgetMax:e.budgetMax||"",propertyType:Array.isArray(g)?g:[],inquiryCount:f?.inquiryCount||f?.additionalDetails?.inquiryCount||0,regions:Array.isArray(f?.preferences?.region)?f.preferences.region:Array.isArray(f?.additionalDetails?.preferences?.region)?f.additionalDetails.preferences.region:[]}},[f]);return(0,b.jsxs)("div",{className:"w-full mx-auto",children:[(0,b.jsx)("div",{className:"rounded-[10px] bg-white mb-6 p-6 shadow-[0_0_1px_#171a1f12,0_0_2px_#171a1f1F]",children:i?(0,b.jsxs)("div",{className:"animate-pulse flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-16 h-16 rounded-full bg-gray-200"}),(0,b.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,b.jsx)("div",{className:"h-4 bg-gray-200 rounded w-32"}),(0,b.jsx)("div",{className:"h-3 bg-gray-200 rounded w-64"})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("img",{src:m.image,alt:"Profile",className:"w-16 h-16 rounded-full object-cover border-2 border-gray-200"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-[18px] font-semibold text-gray-900 mb-1",children:m.name}),(0,b.jsx)("div",{className:"text-[14px] text-gray-500",children:m.email||"-"})]})]}),(0,b.jsxs)("button",{type:"button",onClick:()=>e.push("/customer-profile?mode=edit"),className:"inline-flex items-center gap-2 px-4 py-2 rounded-md text-white bg-green-900 hover:bg-green-800 text-[14px] font-medium transition-colors",children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit Profile"]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-gray-500 text-[12px] mb-1",children:"Gender"}),(0,b.jsx)("div",{className:"text-gray-900 text-[14px] capitalize",children:m.gender||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-gray-500 text-[12px] mb-1",children:"Preferred Property Types"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:m.propertyType&&m.propertyType.length>0?m.propertyType.map((a,c)=>(0,b.jsx)("span",{className:"px-2.5 py-1 rounded-full bg-gray-50 border border-gray-200 text-[12px] text-gray-800 capitalize",children:a},c)):(0,b.jsx)("span",{className:"text-gray-900 text-[14px]",children:"-"})})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-gray-500 text-[12px] mb-1",children:"Date of Birth"}),(0,b.jsx)("div",{className:"text-gray-900 text-[14px]",children:m.dateOfBirth||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-gray-500 text-[12px] mb-1",children:"Budget Range"}),(0,b.jsx)("div",{className:"text-gray-900 text-[14px]",children:m.budgetMin&&m.budgetMax?`₹${Number(m.budgetMin).toLocaleString("en-IN")} - ₹${Number(m.budgetMax).toLocaleString("en-IN")}`:"-"})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-gray-500 text-[12px] mb-1",children:"Joined Date"}),(0,b.jsx)("div",{className:"text-gray-900 text-[14px]",children:m.joinedDateFormatted||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-gray-500 text-[12px] mb-1",children:"Phone"}),(0,b.jsx)("div",{className:"text-gray-900 text-[14px]",children:m.phone||"-"})]})]})]})]})}),k&&(0,b.jsx)("div",{className:"text-[12px] text-red-600 mt-6",children:k})]})}var j=a.i(86341);let k=a=>{if(!a||"string"!=typeof a)return a;let b="https://broker-adda-be.fly.dev";if(a.startsWith("/opt/lampp/htdocs/")){let c=a.split("/").pop();return`${b}/uploads/${c}`}return a.startsWith("/uploads/")?`${b}${a}`:a};function l(){let{user:a}=(0,g.useAuth)(),e=(0,d.useRouter)(),[f,i]=(0,c.useState)(!0),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)({name:"",email:"",phone:"",budgetMin:"",budgetMax:"",propertyType:[],customerImage:null,gender:"",dateOfBirth:""}),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(!1),v=[{value:"residential",label:"Residential"},{value:"commercial",label:"Commercial"},{value:"plot",label:"Plot"},{value:"other",label:"Other "}];(0,c.useEffect)(()=>{let b=async()=>{try{if(!a?.token)return void i(!1);let b=a.userId;if(!b){h.default.error("Customer ID not found in token"),i(!1);return}let c=await fetch(`https://broker-adda-be.fly.dev/api/customers/${b}`,{headers:{Authorization:`Bearer ${a.token}`,Accept:"application/json"}});if(c.ok){let a=await c.json(),b=a?.data?.customer||a?.data||a,d=k(b.images?.customerImage||b.files?.customerImage||b.customerImage||null),e=b.preferences||{},f=e.budgetMin||"",g=e.budgetMax||"",h=e.propertyType||[],i=b.gender||n.gender||"",j=b.dateOfBirth||b.dob||n.dateOfBirth||"";o(a=>({...a,name:b.name||a.name,email:b.email||a.email,phone:b.phone||a.phone,budgetMin:f,budgetMax:g,propertyType:h,inquiryCount:b.inquiryCount||a.inquiryCount,customerImage:d,gender:i,dateOfBirth:j}))}}catch(a){h.default.error("Failed to load customer data")}finally{i(!1)}};a?.userId&&b()},[a?.userId,a?.token]);let w=a=>{let{name:b,value:c}=a.target;o(a=>({...a,[b]:c})),"email"===b&&q(""),("budgetMin"===b||"budgetMax"===b)&&s("")},x=async b=>{if(b.preventDefault(),!n.name.trim())return void h.default.error("Please enter your name");if(!n.email.trim())return void h.default.error("Please enter your email");if(n.budgetMin&&n.budgetMax&&parseFloat(n.budgetMin)>=parseFloat(n.budgetMax)){s("Maximum budget must be greater than minimum budget"),h.default.error("Maximum budget must be greater than minimum budget");return}try{if(!a?.token)return void h.default.error("No authentication token found. Please login again.");m(!0);let b=new FormData;b.append("phone",n.phone||""),b.append("name",n.name),b.append("email",n.email),b.append("customerDetails[preferences][budgetMin]",n.budgetMin?Number(n.budgetMin):""),b.append("customerDetails[preferences][budgetMax]",n.budgetMax?Number(n.budgetMax):""),n.propertyType.forEach((a,c)=>{b.append(`customerDetails[preferences][propertyType][${c}]`,a)}),b.append("customerDetails[gender]",n.gender||""),n.dateOfBirth&&b.append("customerDetails[dateOfBirth]",n.dateOfBirth),b.append("customerDetails[inquiryCount]",n.inquiryCount||0),n.customerImage&&(n.customerImage instanceof File?b.append("customerImage",n.customerImage):n.customerImage);let c=await fetch("https://broker-adda-be.fly.dev/api/auth/complete-profile",{method:"POST",headers:{Authorization:`Bearer ${a.token}`},body:b});if(!c.ok){let a="Failed to update profile";try{let b=await c.json();a=b.error&&b.error.includes("E11000")?"This email address is already registered. Please use a different email.":b.error&&b.error.includes("validation")?b.message||"Validation error. Please check your input.":b.message||b.error||"Failed to update profile"}catch{}h.default.error(a);return}await c.json(),h.default.success("Profile updated successfully!"),setTimeout(()=>{e.push("/customer-profile?mode=view")},1500)}catch(a){h.default.error("Network error. Please try again.")}finally{m(!1)}};if(f)return(0,b.jsx)("div",{className:"w-full mx-auto px-4 sm:px-6 lg:px-8 max-w-7xl",children:(0,b.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,b.jsx)("div",{className:"h-8 bg-gray-200 rounded w-64"}),(0,b.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})});let y=(a=>{if(!a)return null;if("string"==typeof a)return k(a);try{return URL.createObjectURL(a)}catch{return null}})(n.customerImage),z=v.filter(a=>n.propertyType.includes(a.value));return(0,b.jsx)("div",{className:"w-full mx-auto ",children:(0,b.jsxs)("form",{onSubmit:x,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[(0,b.jsx)("h3",{className:"text-[18px] font-semibold text-gray-900 mb-4",children:"Profile Picture"}),(0,b.jsxs)("div",{className:"flex items-center gap-6",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-gray-100 border-2 border-gray-200 flex items-center justify-center",children:y?(0,b.jsx)("img",{src:y,alt:"Profile",className:"w-full h-full object-cover"}):(0,b.jsx)("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,b.jsx)("input",{type:"file",name:"customerImage",onChange:a=>{let b=a.target.files?.[0];b&&o(a=>({...a,customerImage:b}))},accept:".jpg,.jpeg,.png",className:"hidden",id:"customer-image-upload"}),(0,b.jsx)("button",{type:"button",className:"absolute -bottom-1 -right-1 bg-[#0D542B] w-8 h-8 rounded-full flex items-center justify-center hover:bg-[#0B4624] transition-all shadow-lg",onClick:()=>document.getElementById("customer-image-upload").click(),children:(0,b.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:(0,b.jsx)("path",{d:"M21 9C21 8.73478 20.8946 8.48051 20.707 8.29297C20.5429 8.12883 20.3276 8.02757 20.0986 8.00488L20 8H17C16.7033 8 16.4214 7.86856 16.2314 7.64062L14.0312 5H9.96875L7.76855 7.64062C7.57856 7.86856 7.29674 8 7 8H4C3.73478 8 3.48051 8.10543 3.29297 8.29297C3.10543 8.48051 3 8.73478 3 9V18C3 18.2652 3.10543 18.5195 3.29297 18.707C3.48051 18.8946 3.73478 19 4 19H20C20.2652 19 20.5195 18.8946 20.707 18.707C20.8946 18.5195 21 18.2652 21 18V9Z",fill:"white"})})})]}),(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsx)("p",{className:"text-[12px] text-gray-600",children:"Upload a profile picture to personalize your account"})})]})]}),(0,b.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[(0,b.jsx)("h3",{className:"text-[18px] font-semibold text-gray-900 mb-6",children:"Personal Information"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-[14px] font-medium text-gray-900 mb-2",children:["Full Name ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"text",name:"name",value:n.name,onChange:w,placeholder:"Enter your full name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-[12px] focus:outline-none focus:ring-2 focus:ring-green-100 focus:border-green-600",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-[14px] font-medium text-gray-900 mb-2",children:["Email Address ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"email",name:"email",value:n.email,onChange:w,placeholder:"Enter your email",className:`w-full px-3 py-2 border rounded-lg text-[12px] focus:outline-none focus:ring-2 ${p?"border-red-300 focus:ring-red-100 focus:border-red-500":"border-gray-300 focus:ring-green-100 focus:border-green-600"}`,required:!0}),p&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-600",children:p})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-[14px] font-medium text-gray-900 mb-2",children:"Phone Number"}),(0,b.jsx)("input",{type:"tel",name:"phone",value:n.phone,disabled:!0,className:"w-full px-3 py-2 bg-gray-100 border border-gray-200 rounded-lg text-[12px] text-gray-500 cursor-not-allowed"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-[14px] font-medium text-gray-900 mb-2",children:"Gender"}),(0,b.jsxs)("div",{className:"flex gap-6",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>o(a=>({...a,gender:"male"})),className:`flex items-center justify-center w-10 h-10 rounded-full transition-all ${"male"===n.gender?"bg-[#0D542B] text-white":"bg-white text-gray-600 border border-gray-300"}`,children:(0,b.jsxs)("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,b.jsx)("circle",{cx:"12",cy:"5",r:"2"}),(0,b.jsx)("path",{d:"M9 9h6"}),(0,b.jsx)("path",{d:"M9 9l-3 6h12l-3-6z"}),(0,b.jsx)("path",{d:"M8 22v-6M16 22v-6"})]})}),(0,b.jsx)("span",{className:"text-[12px] font-medium text-gray-900",children:"Male"})]}),(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>o(a=>({...a,gender:"female"})),className:`flex items-center justify-center w-10 h-10 rounded-full transition-all ${"female"===n.gender?"bg-[#0D542B] text-white":"bg-white text-gray-500 border border-gray-300"}`,children:(0,b.jsxs)("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,b.jsx)("circle",{cx:"12",cy:"5",r:"2"}),(0,b.jsx)("path",{d:"M9 9h6"}),(0,b.jsx)("path",{d:"M7 22V12a3 3 0 0 1 3-3h4a3 3 0 0 1 3 3v10"}),(0,b.jsx)("path",{d:"M10 22v-7M14 22v-7"})]})}),(0,b.jsx)("span",{className:"text-[12px] font-medium text-gray-900",children:"Female"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-[14px] font-medium text-gray-900 mb-2",children:"Date of Birth"}),(0,b.jsx)("input",{type:"date",name:"dateOfBirth",value:n.dateOfBirth,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-[12px] focus:outline-none focus:ring-2 focus:ring-green-100 focus:border-green-600"})]})]})]}),(0,b.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[(0,b.jsx)("h3",{className:"text-[18px] font-semibold text-gray-900 mb-6",children:"Property Preferences"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-[14px] font-medium text-gray-900 mb-2",children:"Minimum Budget (₹)"}),(0,b.jsx)("input",{type:"number",name:"budgetMin",value:n.budgetMin,onChange:w,placeholder:"Enter minimum budget",className:`w-full px-3 py-2 border rounded-lg text-[12px] focus:outline-none focus:ring-2 ${r?"border-red-300 focus:ring-red-100 focus:border-red-500":"border-gray-300 focus:ring-green-100 focus:border-green-600"}`})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-[14px] font-medium text-gray-900 mb-2",children:"Maximum Budget (₹)"}),(0,b.jsx)("input",{type:"number",name:"budgetMax",value:n.budgetMax,onChange:w,placeholder:"Enter maximum budget",className:`w-full px-3 py-2 border rounded-lg text-[12px] focus:outline-none focus:ring-2 ${r?"border-red-300 focus:ring-red-100 focus:border-red-500":"border-gray-300 focus:ring-green-100 focus:border-green-600"}`}),r&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-600",children:r})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("label",{className:"block text-[14px] font-medium text-gray-900 mb-2",children:"Preferred Property Types"}),(0,b.jsx)(j.default,{isMulti:!0,options:v,value:z,onChange:a=>{let b=a?a.map(a=>a.value):[];o(a=>({...a,propertyType:b}))},placeholder:"Select property types...",className:"react-select-container",classNamePrefix:"react-select",styles:{control:(a,b)=>({...a,border:b.isFocused?"1px solid #0D542B":"1px solid #DEE1E6",boxShadow:b.isFocused?"0 0 0 3px rgba(13, 84, 43, 0.1)":"none"})}})]})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,b.jsx)("button",{type:"button",onClick:()=>e.push("/customer-profile?mode=view"),className:"px-6 py-2 border border-gray-300 rounded-lg text-[14px] font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:l,className:"px-6 py-2 bg-[#0D542B] text-white rounded-lg text-[14px] font-medium hover:bg-[#0B4624] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Saving...":"Save Changes"})]})]})})}function m(){let{user:a}=(0,g.useAuth)(),e=(0,d.useRouter)(),[f,i]=(0,c.useState)(!1),[k,l]=(0,c.useState)({name:"",email:"",phone:a?.phone||"",budgetMin:"",budgetMax:"",propertyType:[],customerImage:null,gender:"",dateOfBirth:""}),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(""),q=[{value:"residential",label:"Residential"},{value:"commercial",label:"Commercial"},{value:"plot",label:"Plot"},{value:"other",label:"Other"}],r=a=>{let{name:b,value:c}=a.target;l(a=>({...a,[b]:c})),"email"===b&&n(""),("budgetMin"===b||"budgetMax"===b)&&p("")},s=async b=>{if(b.preventDefault(),!k.name||!k.email||!k.phone||!k.gender)return void h.default.error("Please fill in all required fields");if(k.budgetMin&&k.budgetMax&&parseFloat(k.budgetMin)>parseFloat(k.budgetMax)){p("Minimum budget should be less than or equal to maximum budget"),h.default.error("Please fix budget range error");return}i(!0);try{let b=new FormData;b.append("phone",k.phone||""),b.append("name",k.name),b.append("email",k.email),b.append("customerDetails[preferences][budgetMin]",k.budgetMin?Number(k.budgetMin):""),b.append("customerDetails[preferences][budgetMax]",k.budgetMax?Number(k.budgetMax):""),k.propertyType.forEach((a,c)=>{b.append(`customerDetails[preferences][propertyType][${c}]`,a)}),b.append("customerDetails[gender]",k.gender||""),k.dateOfBirth&&b.append("customerDetails[dateOfBirth]",k.dateOfBirth),b.append("customerDetails[inquiryCount]",0),k.customerImage instanceof File&&b.append("customerImage",k.customerImage);let c=await fetch("https://broker-adda-be.fly.dev/api/auth/complete-profile",{method:"POST",headers:{Authorization:`Bearer ${a.token}`},body:b});if(!c.ok){let a="Failed to create profile";try{let b=await c.json();a=b.error&&b.error.includes("E11000")?"This email address is already registered. Please use a different email.":b.error&&b.error.includes("validation")?b.message||"Validation error. Please check your input.":b.message||b.error||"Failed to create profile"}catch{}h.default.error(a),i(!1);return}await c.json(),h.default.success("Profile created successfully!"),setTimeout(()=>{e.push("/customer-profile?mode=view")},1500)}catch(a){h.default.error("Failed to create profile. Please try again."),i(!1)}},t=(a=>{if(!a)return null;if("string"==typeof a)return a;try{return URL.createObjectURL(a)}catch{return null}})(k.customerImage),u=q.filter(a=>k.propertyType.includes(a.value));return(0,b.jsx)("div",{className:"w-full mx-auto",children:(0,b.jsxs)("form",{onSubmit:s,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[(0,b.jsx)("h3",{className:"text-[18px] font-semibold text-gray-900 mb-4",children:"Profile Picture"}),(0,b.jsxs)("div",{className:"flex items-center gap-6",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-gray-100 border-2 border-gray-200 flex items-center justify-center",children:t?(0,b.jsx)("img",{src:t,alt:"Profile",className:"w-full h-full object-cover"}):(0,b.jsx)("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),(0,b.jsx)("input",{type:"file",name:"customerImage",onChange:a=>{let b=a.target.files[0];if(b){if(b.size>5242880)return void h.default.error("Image size should be less than 5MB");l(a=>({...a,customerImage:b}))}},accept:".jpg,.jpeg,.png",className:"hidden",id:"customer-image-upload"}),(0,b.jsx)("button",{type:"button",className:"absolute -bottom-1 -right-1 bg-[#0D542B] w-8 h-8 rounded-full flex items-center justify-center hover:bg-[#0B4624] transition-all shadow-lg",onClick:()=>document.getElementById("customer-image-upload").click(),children:(0,b.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:(0,b.jsx)("path",{d:"M21 9C21 8.73478 20.8946 8.48051 20.707 8.29297C20.5429 8.12883 20.3276 8.02757 20.0986 8.00488L20 8H17C16.7033 8 16.4214 7.86856 16.2314 7.64062L14.0312 5H9.96875L7.76855 7.64062C7.57856 7.86856 7.29674 8 7 8H4C3.73478 8 3.48051 8.10543 3.29297 8.29297C3.10543 8.48051 3 8.73478 3 9V18C3 18.2652 3.10543 18.5195 3.29297 18.707C3.48051 18.8946 3.73478 19 4 19H20C20.2652 19 20.5195 18.8946 20.707 18.707C20.8946 18.5195 21 18.2652 21 18V9Z",fill:"white"})})})]}),(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsx)("p",{className:"text-[12px] text-gray-600",children:"Upload a profile picture to personalize your account"})})]})]}),(0,b.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[(0,b.jsx)("h3",{className:"text-[18px] font-semibold text-gray-900 mb-6",children:"Personal Information"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-[14px] font-medium text-gray-900 mb-2",children:["Full Name ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"text",name:"name",value:k.name,onChange:r,placeholder:"Enter your full name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-[12px] focus:outline-none focus:ring-2 focus:ring-green-100 focus:border-green-600",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-[14px] font-medium text-gray-900 mb-2",children:["Email Address ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"email",name:"email",value:k.email,onChange:r,placeholder:"Enter your email",className:`w-full px-3 py-2 border rounded-lg text-[12px] focus:outline-none focus:ring-2 ${m?"border-red-300 focus:ring-red-100 focus:border-red-500":"border-gray-300 focus:ring-green-100 focus:border-green-600"}`,required:!0}),m&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-600",children:m})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-[14px] font-medium text-gray-900 mb-2",children:"Phone Number"}),(0,b.jsx)("input",{type:"tel",name:"phone",value:k.phone,disabled:!0,className:"w-full px-3 py-2 bg-gray-100 border border-gray-200 rounded-lg text-[12px] text-gray-500 cursor-not-allowed"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-[14px] font-medium text-gray-900 mb-2",children:"Gender"}),(0,b.jsxs)("div",{className:"flex gap-6",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>l(a=>({...a,gender:"male"})),className:`flex items-center justify-center w-10 h-10 rounded-full transition-all ${"male"===k.gender?"bg-[#0D542B] text-white":"bg-white text-gray-600 border border-gray-300"}`,children:(0,b.jsxs)("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,b.jsx)("circle",{cx:"12",cy:"5",r:"2"}),(0,b.jsx)("path",{d:"M9 9h6"}),(0,b.jsx)("path",{d:"M9 9l-3 6h12l-3-6z"}),(0,b.jsx)("path",{d:"M8 22v-6M16 22v-6"})]})}),(0,b.jsx)("span",{className:"text-[12px] font-medium text-gray-900",children:"Male"})]}),(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>l(a=>({...a,gender:"female"})),className:`flex items-center justify-center w-10 h-10 rounded-full transition-all ${"female"===k.gender?"bg-[#0D542B] text-white":"bg-white text-gray-500 border border-gray-300"}`,children:(0,b.jsxs)("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,b.jsx)("circle",{cx:"12",cy:"5",r:"2"}),(0,b.jsx)("path",{d:"M9 9h6"}),(0,b.jsx)("path",{d:"M7 22V12a3 3 0 0 1 3-3h4a3 3 0 0 1 3 3v10"}),(0,b.jsx)("path",{d:"M10 22v-7M14 22v-7"})]})}),(0,b.jsx)("span",{className:"text-[12px] font-medium text-gray-900",children:"Female"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-[14px] font-medium text-gray-900 mb-2",children:"Date of Birth"}),(0,b.jsx)("input",{type:"date",name:"dateOfBirth",value:k.dateOfBirth,onChange:r,className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-[12px] focus:outline-none focus:ring-2 focus:ring-green-100 focus:border-green-600"})]})]})]}),(0,b.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[(0,b.jsx)("h3",{className:"text-[18px] font-semibold text-gray-900 mb-6",children:"Property Preferences"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-[14px] font-medium text-gray-900 mb-2",children:"Minimum Budget (₹)"}),(0,b.jsx)("input",{type:"number",name:"budgetMin",value:k.budgetMin,onChange:r,placeholder:"Enter minimum budget",className:`w-full px-3 py-2 border rounded-lg text-[12px] focus:outline-none focus:ring-2 ${o?"border-red-300 focus:ring-red-100 focus:border-red-500":"border-gray-300 focus:ring-green-100 focus:border-green-600"}`})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-[14px] font-medium text-gray-900 mb-2",children:"Maximum Budget (₹)"}),(0,b.jsx)("input",{type:"number",name:"budgetMax",value:k.budgetMax,onChange:r,placeholder:"Enter maximum budget",className:`w-full px-3 py-2 border rounded-lg text-[12px] focus:outline-none focus:ring-2 ${o?"border-red-300 focus:ring-red-100 focus:border-red-500":"border-gray-300 focus:ring-green-100 focus:border-green-600"}`}),o&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-600",children:o})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("label",{className:"block text-[14px] font-medium text-gray-900 mb-2",children:"Preferred Property Types"}),(0,b.jsx)(j.default,{isMulti:!0,options:q,value:u,onChange:a=>{let b=a?a.map(a=>a.value):[];l(a=>({...a,propertyType:b}))},placeholder:"Select property types...",className:"react-select-container",classNamePrefix:"react-select",styles:{control:(a,b)=>({...a,border:b.isFocused?"1px solid #0D542B":"1px solid #DEE1E6",boxShadow:b.isFocused?"0 0 0 3px rgba(13, 84, 43, 0.1)":"none"})}})]})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,b.jsx)("button",{type:"button",onClick:()=>e.push("/customer-profile?mode=view"),className:"px-6 py-2 border border-gray-300 rounded-lg text-[14px] font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:f,className:"px-6 py-2 bg-[#0D542B] text-white rounded-lg text-[14px] font-medium hover:bg-[#0B4624] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Creating...":"Create Profile"})]})]})})}let n=()=>{let{user:a,isAuthenticated:j}=(0,g.useAuth)();(0,d.useRouter)();let k=(0,d.useSearchParams)(),[n,o]=(0,c.useState)("view");return((0,c.useEffect)(()=>{o(k?.get("mode")||"view")},[k]),"create"===n)?(0,b.jsxs)(e.default,{requiredRole:"customer",children:[(0,b.jsx)(h.Toaster,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,iconTheme:{primary:"#4ade80",secondary:"#fff"}},error:{duration:4e3,iconTheme:{primary:"#ef4444",secondary:"#fff"}}}}),(0,b.jsx)(f.default,{data:{title:"Create Customer Profile",breadcrumb:[{label:"Home",href:"/"},{label:"Customer Profile",href:"/customer-profile"},{label:"Create",href:"/customer-profile?mode=create"}]}}),(0,b.jsx)("div",{className:"min-h-screen bg-white py-12",children:(0,b.jsx)(m,{})})]}):"view"===n?(0,b.jsxs)(e.default,{requiredRole:"customer",children:[(0,b.jsx)(h.Toaster,{position:"top-right"}),(0,b.jsx)(f.default,{data:{title:"Customer Profile",breadcrumb:[{label:"Home",href:"/"},{label:"Customer Profile",href:"/customer-profile"}]}}),(0,b.jsx)("div",{className:" bg-white py-12",children:(0,b.jsx)(i,{})})]}):"edit"===n?(0,b.jsxs)(e.default,{requiredRole:"customer",children:[(0,b.jsx)(h.Toaster,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,iconTheme:{primary:"#4ade80",secondary:"#fff"}},error:{duration:4e3,iconTheme:{primary:"#ef4444",secondary:"#fff"}}}}),(0,b.jsx)(f.default,{data:{title:"Edit Customer Profile",breadcrumb:[{label:"Home",href:"/"},{label:"Customer Profile",href:"/customer-profile"},{label:"Edit",href:"/customer-profile?mode=edit"}]}}),(0,b.jsx)("div",{className:"min-h-screen bg-white py-12",children:(0,b.jsx)(l,{})})]}):null},o=()=>(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{children:"Loading..."}),children:(0,b.jsx)(n,{})})}];

//# sourceMappingURL=Desktop_Broker%20adda_broker-adda-web_src_app_customer-profile_page_jsx_f65f3752._.js.map